---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "bloxone_td_security_policy Resource - terraform-provider-bloxone"
subcategory: "Threat Defense"
description: |-
  Creates and Manages Security Policies.
---

# bloxone_td_security_policy (Resource)

Creates and Manages Security Policies.

## Example Usage

```terraform
resource "bloxone_td_named_list" "example" {
  name = "example_named_list"
  items_described = [
    {
      item        = "tf-domain.com"
      description = "Example Domain"
    }
  ]
  type = "custom_list"
}

resource "bloxone_td_security_policy" "example" {
  name = "example_security_policy"

  # Other optional fields
  rules = [
    {
      action = "action_allow",
      data   = bloxone_td_named_list.example.name,
      type   = bloxone_td_named_list.example.type
    }
  ]
  description    = "Example Security Policy"
  ecs            = true
  onprem_resolve = true
  safe_search    = false
  tags = {
    site = "Site A"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the security policy.

### Optional

- `access_codes` (List of String) Access codes assigned to Security Policy
- `default_action` (String) The policy-level action gets applied when none of the policy rules apply/match. The default value for default_action is "action_allow".
- `default_redirect_name` (String) Name of the custom redirect, if the default_action is "action_redirect".
- `description` (String) The brief description for the security policy.
- `dfps` (List of Number) The list of DNS Forwarding Proxy object identifiers.
- `ecs` (Boolean) Use ECS for handling policy
- `net_address_dfps` (Attributes List) List of DFPs associated with this policy via network address (with corresponding network address) (see [below for nested schema](#nestedatt--net_address_dfps))
- `network_lists` (List of Number) The list of Network Lists identifiers that represents networks that you want to protect from malicious attacks.
- `onprem_resolve` (Boolean) Use DNS resolve on onprem side
- `precedence` (Number) Security precedence enable selection of the highest priority policy, in cases where a query matches multiple policies.
- `roaming_device_groups` (List of Number) The list of BloxOne Endpoint groups identifiers.
- `rules` (Attributes List) The list of Security Policy Rules objects that represent the set of rules and actions that you define to balance access and constraints so you can mitigate malicious attacks and provide security for your networks. (see [below for nested schema](#nestedatt--rules))
- `safe_search` (Boolean) Apply automated rules to enforce safe search
- `tags` (Map of String) Enables tag support for resource where tags attribute contains user-defined key value pairs
- `user_groups` (List of String) List of user groups associated with this policy

### Read-Only

- `created_time` (String) The time when this Security Policy object was created.
- `dfp_services` (List of String) The list of DNS Forwarding Proxy Services object identifiers. For Internal Use only.
- `id` (Number) The Security Policy object identifier.
- `is_default` (Boolean) Flag that indicates whether this is a default security policy.
- `tags_all` (Map of String) The tags for the security policy, including default tags.
- `updated_time` (String) The time when this Security Policy object was last updated.

<a id="nestedatt--net_address_dfps"></a>
### Nested Schema for `net_address_dfps`

Optional:

- `addr_net` (String) network address in IPv4 CIDR (address/bitmask length) string format
- `end` (String)
- `external_scope_id` (String) external scope ID, UUID
- `host_id` (String) Host reference, UUID
- `ip_space_id` (String) IPSpace reference, UUID
- `scope_type` (String)
- `start` (String) Start and end pair of addresses used for range scope type

Read-Only:

- `dfp_ids` (List of Number) The list of identifiers of DFPs that have association with this scope.
- `dfp_service_ids` (List of String)


<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Optional:

- `action` (String) The action for the policy rule that can be either "action_allow" or "action_log" or "action_redirect" or "action_block" or "action_allow_with_local_resolution". "action_allow_with_local_resolution" only supported for application filter rule with enabled onprem_resolve flag on the Security policy.
- `data` (String) The data source for the policy rule, that can be either a name of the predefined feed for "named_feed", custom list name for "custom_list" type, category filter name for "category_filter" type and application filter name for "application_filter" type.
- `policy_name` (String) The name of the security policy with which the policy rule is associated.
- `redirect_name` (String) The name of the redirect address for redirect actions that can be either IPv4 address or a domain name.
- `type` (String) The policy rule type that can be either "named_feed" or "custom_list" or "category_filter" or "application_filter".

Read-Only:

- `list_id` (Number) The Custom List object identifier with which the policy rule is associated. 0 value means no custom list is associated with this policy rule.
- `policy_id` (Number) The identifier of the Security Policy object with which the policy rule is associated.
